# .env.production.example for podcast-rag project with Supabase

# ============================================================================
# SUPABASE POSTGRESQL CONFIGURATION
# ============================================================================

# --- Supabase PostgreSQL Database ---
# Use the transaction pooler (port 6543) for application connections
# Format: postgresql://postgres.[PROJECT-REF]:[PASSWORD]@aws-0-[REGION].pooler.supabase.com:6543/postgres
# Replace [PROJECT-REF], [PASSWORD], and [REGION] with your Supabase project details
DATABASE_URL=postgresql://postgres.[PROJECT-REF]:[PASSWORD]@aws-0-[REGION].pooler.supabase.com:6543/postgres

# --- Supabase-Optimized Connection Pool Settings ---
# Lower pool sizes optimized for Supabase's connection limits
DB_POOL_SIZE=3
DB_MAX_OVERFLOW=2
DB_POOL_PRE_PING=true
DB_ECHO=false

# --- Supabase API Configuration (for future features - Phase 2) ---
# Get these from Supabase Dashboard → Project Settings → API
SUPABASE_URL=https://[PROJECT-REF].supabase.co
SUPABASE_ANON_KEY=[your-anon-key]
SUPABASE_SERVICE_ROLE_KEY=[your-service-role-key]

# ============================================================================
# EXISTING CONFIGURATION (from .env.example)
# ============================================================================

# --- Service Configuration ---
# Base directory for local media (where downloaded podcasts are stored)
MEDIA_EMBED_BASE_DIRECTORY=/path/to/your/podcasts

# --- Gemini API Configuration ---
# Google Gemini API key for AI features (metadata extraction, RAG queries)
GEMINI_API_KEY=your_gemini_api_key_here
# Gemini model to use (e.g., gemini-2.5-flash, gemini-2.5-pro)
GEMINI_MODEL=gemini-2.5-flash

# --- Gemini File Search Configuration ---
# Name of the File Search store for podcast transcripts
GEMINI_FILE_SEARCH_STORE_NAME=podcast-transcripts

# --- Email Configuration (Resend) ---
# Resend API key for sending emails (leave blank to disable email features)
# Get your API key from: https://resend.com/api-keys
RESEND_API_KEY=
# Email address to send from (must be verified in Resend)
RESEND_FROM_EMAIL=podcast@example.com
# Display name for sender
RESEND_FROM_NAME="Podcast RAG"

# --- Web App Base URL (for email links) ---
# Base URL for the web application (used in email links)
WEB_BASE_URL=https://your-domain.com

# --- Email Digest Settings ---
# Hour of day (0-23) to send daily digest emails
EMAIL_DIGEST_SEND_HOUR=8
# Timezone for scheduling (IANA timezone name)
EMAIL_DIGEST_TIMEZONE=America/Los_Angeles

# --- Google OAuth Configuration ---
# Get these from Google Cloud Console
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
GOOGLE_REDIRECT_URI=https://your-domain.com/auth/callback

# --- JWT Configuration ---
# Secret key for JWT token signing (generate a strong random key)
JWT_SECRET_KEY=your_secret_key_here
JWT_EXPIRATION_DAYS=7

# --- Cookie Configuration ---
# Set to true in production (requires HTTPS)
COOKIE_SECURE=true
# Optional: Set specific domain for cookies
# COOKIE_DOMAIN=yourdomain.com

# ============================================================================
# NOTES
# ============================================================================
#
# 1. Database Connection:
#    - Use port 6543 (pooler) for application connections
#    - Use port 5432 (direct) only for Alembic migrations
#
# 2. Supabase Project Setup:
#    - Create project at https://supabase.com/dashboard
#    - Get credentials from Project Settings → Database
#    - Choose region closest to your users
#
# 3. Security:
#    - Never commit this file with real credentials to git
#    - Use strong passwords for DATABASE_URL and JWT_SECRET_KEY
#    - Keep SUPABASE_SERVICE_ROLE_KEY secure (has admin access)
#
# 4. Migration:
#    - Run migrations with: ALEMBIC_DATABASE_URL=postgresql://... alembic upgrade head
#    - Use port 5432 (direct connection) for migrations
#
# 5. Rollback:
#    - Keep your old .env backed up as .env.sqlite.backup
#    - Can revert to SQLite by swapping .env files
#
# 6. Cloud Run Deployment:
#    - Use scripts/setup_cloud_run_env.sh to sync .env to Cloud Run
#    - Sensitive values are stored in Secret Manager automatically
#    - Update CLOUD_RUN_URL to your custom domain or Cloud Run URL
#

# ============================================================================
# CLOUD RUN CONFIGURATION
# ============================================================================

# --- Cloud Run Service Configuration ---
# Used by scripts/setup_cloud_run_env.sh for auto-deployment
CLOUD_RUN_SERVICE=podcast-rag-web
CLOUD_RUN_REGION=us-west2
CLOUD_RUN_URL=https://your-app.run.app  # Replace with your Cloud Run URL or custom domain
